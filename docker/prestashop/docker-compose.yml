services:
  prestashop:
    container_name: prestashop
    image: prestashop/prestashop:8.2.3
    restart: unless-stopped
    ports:
        - 8083:80
    environment:
      DB_SERVER: mysql
      DB_NAME: prestashop
      DB_USER: root
      DB_PASSWD: test
      PS_FOLDER_ADMIN: admin4577
      PS_FOLDER_INSTALL: install4577
      PS_INSTALL_AUTO: 1        # ‚ö° Instalaci√≥n autom√°tica
      PS_DEV_MODE: 1            # ‚ö° Habilita modo desarrollador
      PS_LANGUAGE: es           # Idioma por defecto
      PS_COUNTRY: CO            # Pa√≠s por defecto
      PS_TIMEZONE: America/Bogota
      PS_CURRENCY: COP              # Moneda predeterminada (Peso Colombiano)
      ADMIN_MAIL: admin@example.com  # üîë Usuario admin del Back Office
      ADMIN_PASSWD: admin123        # üîë Contrase√±a admin
      #PS_ERASE_DB: 1
      #PS_INSTALL_DB: 1
      # üåê Configuraci√≥n para ngrok
      #PS_DOMAIN: "localhost:8082"
      #PS_SHOP_DOMAIN: "localhost:8082"
      #PS_SHOP_DOMAIN_SSL: "localhost:8082"
      #PS_SSL_ENABLED: 0
      PS_DOMAIN: "${PS_DOMAIN:-localhost:8083}"
      PS_SHOP_DOMAIN: "${PS_SHOP_DOMAIN:-localhost:8083}"
      PS_SHOP_DOMAIN_SSL: "${PS_SHOP_DOMAIN_SSL:-localhost:8083}"
      PS_SSL_ENABLED: "${PS_SSL_ENABLED:-0}"
      PS_SSL_ENABLED_EVERYWHERE: "${PS_SSL_ENABLED_EVERYWHERE:-0}"
    networks:
    - local-network
    volumes:
    - ../../www/prestashop/modules:/var/www/html/modules
    - ../../www/prestashop/themes:/var/www/html/themes
    - psdata:/var/www/html
    - ../../config/app.ini:/usr/local/etc/php/conf.d/app.ini

  ngrok-prestashop:
      image: ngrok/ngrok:latest
      container_name: ngrok-prestashop
      restart: always
      depends_on:
          - prestashop
      environment:
          # Set NGROK_AUTHTOKEN in your shell or in a .env file
          #NGROK_AUTHTOKEN: "${NGROK_AUTHTOKEN:-}"
          NGROK_AUTHTOKEN: "2feD4bEkSMBUEG8PWGh5TdGYm9g_4j8qQsLcUHviwdoVih1P4"
      command: ["http", "prestashop:80"]
      ports:
          - "4043:4040" # ngrok web UI
      networks:
          - local-network

volumes:
    psdata:

networks:
    local-network: